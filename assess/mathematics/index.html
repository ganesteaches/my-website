<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mathematics Branch Hexagon Chain</title>
<style>
  :root{
    --r1:     150px;    /* hexagon “radius”                */
    --centre: 180px;    /* diameter of centre icons        */
    --icon:   110px;    /* diameter of each topic node     */
  }

  *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
  html,body{width:100%;height:100%}
  body{
    display:flex;align-items:center;justify-content:center;
    background:#111;font-family:system-ui,sans-serif;
  }

  .container{position:relative;}
  .container svg{position:absolute;inset:0;pointer-events:none;}

  /* ── centre icons ─────────────────────────────────────────────── */
  .centre{
    position:absolute;width:var(--centre);height:var(--centre);
    border-radius:50%;overflow:visible;
    transform:translate(-50%,-50%);z-index:3;
  }
  .centre.pure       {box-shadow:0 0 24px #4ade80;} /* green */
  .centre.statistics {box-shadow:0 0 24px #fbbf24;} /* amber */
  .centre.mechanics  {box-shadow:0 0 24px #60a5fa;} /* blue  */

  .centre img{width:100%;height:100%;object-fit:cover;border-radius:50%;}

  /* ── peripheral topic nodes ───────────────────────────────────── */
  .node{
    position:absolute;width:var(--icon);height:var(--icon);
    border-radius:50%;background:#111;border:2px solid #fff;
    display:flex;align-items:center;justify-content:center;
    font-size:11px;font-weight:600;color:#fff;text-align:center;
    line-height:1.15;white-space:normal;padding:4px;
    opacity:0;transform:translate(-50%,-50%) scale(.5);
    transition:transform .4s ease, opacity .4s ease;z-index:1;
  }
  .node.pure       {box-shadow:0 0 12px #4ade80;}
  .node.statistics {box-shadow:0 0 12px #fbbf24;}
  .node.mechanics  {box-shadow:0 0 12px #60a5fa;}

  /* ── hexagon outline ──────────────────────────────────────────── */
  .hexagon{
    stroke:#374151;stroke-width:2;fill:none;
    stroke-dasharray:1000;stroke-dashoffset:1000;
    transition:stroke-dashoffset 1s ease;
  }
</style>
</head>
<body>
  <div class="container" id="container"></div>

<script>
/* helper to create URL-friendly slugs */
function slugify(str){
  return str.toLowerCase()
            .replace(/[^a-z0-9]+/g,"-")
            .replace(/(^-|-$)/g,"");
}

(function(){
  /* 1) base URL for maths assessments */
  const BASE    = "https://www.ganesteaches.com/assess/mathematics";
  const R1      = parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--r1"));
  const spacing = Math.sqrt(3)*R1;

  /* 2) branches — draw pure first (so it gets 6 unique vertices) but *position* it in the middle */
  const branches = [
    {   /* drawn 1st (gets 6 nodes) → centre hex */
      key:"pure", cls:"pure", icon:"pure_icon.png", title:"Pure Mathematics",
      posIndex:1,   /* middle visual position */
      topics:[
        {label:"Proof & Algebraic",            full:"Proof & Algebraic Techniques"},
        {label:"Coord. Geom & Vectors",        full:"Coordinate Geometry & Vectors"},
        {label:"Sequences & Series",           full:"Sequences & Series"},
        {label:"Trigonometry",                 full:"Trigonometry"},
        {label:"Calculus",                     full:"Calculus"},
        {label:"Numerical Methods",            full:"Approximation & Numerical Methods"}
      ]
    },
    {   /* drawn 2nd (gets 4 nodes) → left hex */
      key:"statistics", cls:"statistics", icon:"stats_icon.png", title:"Statistics",
      posIndex:0,   /* left visual position */
      topics:[
        {label:"Sampling",             full:"Statistical sampling"},
        {label:"Data Presentation",    full:"Data presentation & interpretation"},
        {label:"Probability",          full:"Probability"},
        {label:"Distributions",        full:"Statistical distributions"}
      ]
    },
    {   /* drawn 3rd (gets 4 nodes) → right hex */
      key:"mechanics", cls:"mechanics", icon:"mech_icon.png",  title:"Mechanics",
      posIndex:2,   /* right visual position */
      topics:[
        {label:"Units",        full:"Quantities and units in mechanics"},
        {label:"Kinematics",   full:"Kinematics"},
        {label:"Forces",       full:"Forces & Newton’s laws"},
        {label:"Moments",      full:"Moments"}
      ]
    }
  ];

  /* 3) build the full ordered topic list (matches vertex order: 6,4,4) */
  const orderedTopics = branches.flatMap(b => b.topics);

  /* 4) size the container */
  const cont   = document.getElementById("container");
  const totalW = 2*R1 + 2*spacing;
  const totalH = 2*R1;
  cont.style.width  = totalW + "px";
  cont.style.height = totalH + "px";

  /* 5) single SVG for all hexagons */
  const svgNS = "http://www.w3.org/2000/svg";
  const svg   = document.createElementNS(svgNS,"svg");
  svg.setAttribute("viewBox",`0 0 ${totalW} ${totalH}`);
  svg.style.width="100%";svg.style.height="100%";
  cont.appendChild(svg);

  /* 6) draw one hexagon and return its 6 corner points */
  function drawHexagon(cx,cy){
    const pts = Array.from({length:6},(_,i)=>{
      const ang = (-90+i*60)*Math.PI/180;
      return [cx+R1*Math.cos(ang), cy+R1*Math.sin(ang)];
    });
    const poly = document.createElementNS(svgNS,"polygon");
    poly.setAttribute("points",pts.map(p=>p.join(",")).join(" "));
    poly.classList.add("hexagon");
    svg.appendChild(poly);

    /* dash-draw animation */
    const perim = pts.reduce((sum,[x,y],i)=>{
      const [nx,ny]=pts[(i+1)%6];
      return sum+Math.hypot(nx-x,ny-y);
    },0);
    poly.style.strokeDasharray=perim;
    poly.style.strokeDashoffset=perim;
    requestAnimationFrame(()=>poly.style.strokeDashoffset="0");

    return pts;
  }

  /* 7) draw all three hexagons (but pure first), collect vertices */
  let allVerts=[];
  branches.forEach((b,drawOrder)=>{
    const cx = R1 + b.posIndex*spacing,
          cy = R1;
    allVerts.push(...drawHexagon(cx,cy));

    /* centre icon link */
    const ctr = document.createElement("a");
    ctr.className=`centre ${b.cls}`;
    ctr.href     =`${BASE}/a-level/${b.key}`;
    ctr.title    =b.title;
    ctr.style.left = cx+"px";
    ctr.style.top  = cy+"px";
    ctr.innerHTML  =`<img src="${b.icon}" alt="${b.title}">`;
    cont.appendChild(ctr);
  });

  /* 8) deduplicate → we need exactly 14 distinct peripheral points */
  const unique=[];
  const tol=1; // px
  allVerts.forEach(pt=>{
    if(!unique.some(u=>Math.abs(u[0]-pt[0])<tol && Math.abs(u[1]-pt[1])<tol)){
      unique.push(pt);
    }
  });

  /* 9) place each node with correct branch/topic information */
  const branchCounters = [0,0,0]; // track which topic we’re on in each branch

  unique.forEach(([x,y],i)=>{
    /* decide which branch this node belongs to based on index ranges 6-4-4 */
    const branchIndex = i < 6 ? 0 : (i < 10 ? 1 : 2);
    const branch      = branches[branchIndex];
    const topicIdx    = branchCounters[branchIndex]++;

    /* if there are more vertices than topics, just skip making a node */
    if(topicIdx >= branch.topics.length) return;

    const topic       = branch.topics[topicIdx];
    const slug        = slugify(topic.full);

    const node = document.createElement("a");
    node.className  = `node ${branch.cls}`;
    node.href       = `${BASE}/a-level/${branch.key}/${slug}`;
    node.title      = topic.full;
    node.style.left = x+"px";
    node.style.top  = y+"px";
    node.textContent = topic.label;
    cont.appendChild(node);

    /* staggered fade-in */
    setTimeout(()=>{
      node.style.opacity  = "1";
      node.style.transform= "translate(-50%, -50%) scale(1)";
    },100 + i*60);
  });
})();
</script>
</body>
</html>
