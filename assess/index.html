<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Ganes Assess – Animated Hexagon</title>

  <style>
    :root {
      --r1:     230px;  /* radius to subject icons           */
      --r2:     320px;  /* radius to GCSE / A-Level / IB ring */
      --icon:   100px;  /* subject‐icon diameter             */
      --bubble:  70px;  /* qualification‐bubble diameter     */
    }

    *, *::before, *::after {
      box-sizing: border-box;
      margin:      0;
      padding:     0;
    }
    html, body {
      width:  100%;
      height: 100%;
    }
    body {
      display:         flex;
      align-items:     center;
      justify-content: center;
      background:      #1a1a1a;   /* page background colour */
      font-family:     system-ui, sans-serif;
      color:           #e2e8f0;
    }

    #chart {
      position: relative;
      width:    900px;
      height:   900px;
    }

    /* centre logo */
    #centre {
      position:      absolute;
      top:           50%;
      left:          50%;
      width:         190px;
      height:        190px;
      transform:     translate(-50%, -50%);
      border-radius: 50%;
      overflow:      hidden;
      filter:        drop-shadow(0 0 16px rgba(56,189,248,0.35));
      will-change:   filter;
    }
    #centre img {
      width:      100%;
      height:     100%;
      object-fit: cover;
    }

    /* subject icons */
    .node {
      position:       absolute;
      left:           50%;
      top:            50%;
      width:          var(--icon);
      height:         var(--icon);
      border-radius:  50%;
      overflow:       hidden;
      border:         3px solid #e2e8f0;
      background:     #1a1a1a;  /* subject‐circle background */
      cursor:         pointer;
      z-index:        1;

      display:        flex;
      align-items:    center;
      justify-content:center;

      transform:      translate(-50%, -50%);
      will-change:    transform, opacity;
      transition:     transform 1.6s ease-out,
                      opacity   1.6s ease-out;
      opacity:        0;
    }
    .node img {
      width:      70%;
      height:     70%;
      object-fit: contain;
    }

    .science { filter: drop-shadow(0 0 14px #fb923c); }
    .maths   { filter: drop-shadow(0 0 14px #60a5fa); }
    .misc    { filter: drop-shadow(0 0 14px #a855f7); }

    /* qualification bubbles */
    .bubble {
      position:        absolute;
      display:         flex;
      align-items:     center;
      justify-content: center;
      width:           var(--bubble);
      height:          var(--bubble);
      border-radius:   50%;
      background:      #1a1a1a;  /* bubble background matches nodes */
      border:          2px solid #64748b;
      font-size:       13px;
      font-weight:     600;
      color:           #e2e8f0;
      text-decoration: none;
      opacity:         0;
      pointer-events:  none;
      transition:      opacity 0.35s;
      z-index:         2;
    }
    .bubble.show {
      opacity:        1;
      pointer-events: auto;
    }

    /* hexagon outline */
    svg {
      position:       absolute;
      inset:          0;
      pointer-events: none;
    }
    polygon {
      stroke:             #64748b;
      stroke-width:       3;
      fill:               none;
      opacity:            0.5;
      transition:         stroke-dashoffset 2s ease-out;
    }
  </style>
</head>
<body>

  <div id="chart">
    <svg id="outline"></svg>

    <a id="centre"
       href="https://www.ganesteaches.com/ganes-assess"
       target="_blank" rel="noopener">
      <img src="../ganes_assess.png" alt="Ganes Assess">
    </a>
  </div>

  <script>
  (function(){
    const BASE     = "https://www.ganesteaches.com/ganes-assess";
    const subjects = [
      { label:"Biology",       key:"biology",            icon:"../biology_list_icon.png",            cls:"science", angle:150 },
      { label:"Chemistry",     key:"chemistry",          icon:"../chemistry_list_icon.png",          cls:"science", angle: 90 },
      { label:"Physics",       key:"physics",            icon:"../physics_list_icon.png",            cls:"science", angle: 30 },
      { label:"Mathematics",   key:"mathematics",        icon:"../mathematics_list_icon.png",        cls:"maths",   angle:210 },
      { label:"Further Maths", key:"further-mathematics",icon:"../further_mathematics_list_icon.png",cls:"maths",   angle:270 },
      { label:"Misc",          key:"misc",               icon:"../physics_list_icon.png",            cls:"misc",    angle:330 }
    ];
    const quals = ["GCSE","A Level","IB"];

    const chart = document.getElementById("chart");
    const svg   = document.getElementById("outline");
    const R1    = parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--r1"));
    const R2    = parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--r2"));
    const ICON  = parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--icon"));
    const BUB   = parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--bubble"));
    const cx    = chart.clientWidth  / 2;
    const cy    = chart.clientHeight / 2;

    let activeNode = null;

    function hideAllBubbles() {
      subjects.forEach(s => s.bubbles.forEach(b => b.classList.remove("show")));
    }

    subjects.forEach(sub => {
      const rad = sub.angle * Math.PI/180;
      const vx  = cx + R1 * Math.cos(rad);
      const vy  = cy + R1 * Math.sin(rad);
      sub.tx = vx - cx;
      sub.ty = vy - cy;

      // create subject circle
      const node = document.createElement("div");
      node.className = `node ${sub.cls}`;
      node.innerHTML = `<img src="${sub.icon}" alt="${sub.label}">`;
      chart.appendChild(node);
      sub.el = node;

      // create qualification bubbles
      sub.bubbles = quals.map((q,i) => {
        const off = -30 + i*30;
        const br  = (sub.angle + off) * Math.PI/180;
        const bx  = cx + R2 * Math.cos(br);
        const by  = cy + R2 * Math.sin(br);
        const a   = document.createElement("a");
        a.className   = "bubble";
        a.textContent = q;
        a.href        = `${BASE}/${sub.key}/${q.toLowerCase().replace(/\s+/g,"-")}`;
        a.target      = "_blank";
        a.rel         = "noopener";
        a.style.left  = `${bx - BUB/2}px`;
        a.style.top   = `${by - BUB/2}px`;
        chart.appendChild(a);

        // keep bubble visible while hovered
        a.addEventListener("mouseenter", () => a.classList.add("show"));
        // hide on leave, unless clicked open
        a.addEventListener("mouseleave", () => {
          if (activeNode !== node) a.classList.remove("show");
        });

        return a;
      });

      // hover: clear old, dim others, show these
      node.addEventListener("mouseenter", () => {
        hideAllBubbles();
        subjects.forEach(s => { if (s !== sub) s.el.style.opacity = 0.3; });
        sub.bubbles.forEach(b => b.classList.add("show"));
      });
      node.addEventListener("mouseleave", () => {
        subjects.forEach(s => s.el.style.opacity = 1);
      });

      // click: toggle persistent bubbles
      node.addEventListener("click", () => {
        if (activeNode === node) {
          hideAllBubbles();
          activeNode = null;
        } else {
          hideAllBubbles();
          activeNode = node;
          sub.bubbles.forEach(b => b.classList.add("show"));
        }
      });
    });

    // draw hexagon outline
    const verts = subjects
      .map(s => ({
        angle: s.angle,
        x:     cx + R1 * Math.cos(s.angle * Math.PI/180),
        y:     cy + R1 * Math.sin(s.angle * Math.PI/180)
      }))
      .sort((a,b) => a.angle - b.angle);

    const pts = verts.map(v => `${v.x},${v.y}`).join(" ");
    svg.setAttribute("viewBox", `0 0 ${chart.clientWidth} ${chart.clientHeight}`);
    const poly = document.createElementNS("http://www.w3.org/2000/svg","polygon");
    poly.setAttribute("points", pts);
    svg.appendChild(poly);

    // calculate and apply dash‐animation
    let per = 0;
    verts.forEach((v,i) => {
      const n = verts[(i+1)%verts.length];
      per += Math.hypot(n.x - v.x, n.y - v.y);
    });
    poly.style.strokeDasharray  = per;
    poly.style.strokeDashoffset = per;

    // entrance animation
    requestAnimationFrame(() => {
      poly.style.strokeDashoffset = 0;
      subjects.forEach(s => {
        s.el.style.transform = `
          translate(-50%, -50%)
          translate(${s.tx}px, ${s.ty}px)
        `;
        s.el.style.opacity = 1;
      });
    });
  })();
  </script>
</body>
</html>
